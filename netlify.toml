[build]
  publish = "dist"
  command = "echo '=== NUCLEAR BUILD v3 ===' && rm -rf node_modules/.cache && rm -rf .vite && rm -rf dist && npm ci --force && cat src/config/firebase.ts | head -20 && npx vite build && echo '=== BUILD COMPLETE ===' && cat dist/assets/*.js | grep -o 'projectId:\"[^\"]*\"' | head -1"

[build.environment]
  NODE_VERSION = "18"
  NPM_FLAGS = "--production=false"
  # Force cache bust
  CACHE_BUST = "v3-nuclear-20241128"

[context.production.environment]
  VITE_FIREBASE_API_KEY = "AIzaSyBhxn1zOtawpaIlYb7TLZFOQakqrm6mZlo"
  VITE_FIREBASE_AUTH_DOMAIN = "stacktrek-98df0.firebaseapp.com"
  VITE_FIREBASE_PROJECT_ID = "stacktrek-98df0"
  VITE_FIREBASE_STORAGE_BUCKET = "stacktrek-98df0.firebasestorage.app"
  VITE_FIREBASE_MESSAGING_SENDER_ID = "1072910879130"
  VITE_FIREBASE_APP_ID = "1:1072910879130:web:9af6b3212f3c33963c1223"

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
